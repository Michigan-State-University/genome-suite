<div class='table' width="100%" style='overflow-x:auto'>
  <table class="listing">
    <tr>
      <th style="width:20px"></th>
      <% @feature_counts.each do |m| %>
        <th><%= link_to m.experiment.name, m.experiment %></th>
      <% end %>
    </tr>
    <tr>
      <td style="width:20px"><b>Unique Reads</b></td>
      <% @feature_counts.each do |m| %>
        <td><%= m.unique_count %></td>
      <% end %>
    </tr>
    <tr>
      <td style="width:20px"><b>Total Reads</b></td>
      <% @feature_counts.each do |m| %>
        <td><%= m.count %></td>
      <% end %>
    </tr>
    <tr>
      <td style="width:20px"><b>RPKM</b></td>
      <% @feature_counts.each do |m| %>
        <td><%= m.normalized_count.round(2) %></td>
      <% end %>
    </tr>
  </table>
</div>

<div id='expression_profile' style="clear:both"></div>

<%= render :partial => "shared/expression_profile", :locals => {
  :feature_counts => @feature_counts,
  :element_id => 'expression_profile',
  :data => coexpressed_counts_seqfeature_path(@gene,:format => :json)
} %>

<br/>

<div class='clear'>
  <div class="border" style="overflow:hidden">
    <h2>Density of Aligned Reads</h2>
    <%= render :partial => "graphic" %>
    <%= render :partial => "shared/base_count_chart", :locals => {:data => feature_counts_seqfeature_path(@gene,:format => :json)} %>
  </div>
</div>

